// define a type representing Lambdapi tactics

require open lambdapi.Alethe;

// define a type representing Lambdapi tactics

constant symbol String : TYPE;
builtin "String" â‰” String;

constant symbol string : Set;
rule Ï„ string â†ª String;

type "hello world!";

compute "hello world!";

assert âŠ¢ "a" : String;

assert âŠ¢ "a" â‰¡ "a";

assertnot âŠ¢ "a" â‰¡ "b";

constant symbol Tactic : TYPE;
 symbol tactic : Set;
 rule Ï„ tactic â†ª Tactic;

constant symbol #admit : Tactic;
builtin "admit" â‰” #admit;

symbol and : Tactic â†’ Tactic â†’ Tactic;
builtin "and" â‰” and;
notation and infix right 15;

constant symbol #apply [p] : Ï€ p â†’ Tactic;
builtin "apply" â‰” #apply;

constant symbol #assume : String â†’ Tactic;
builtin "assume" â‰” #assume;

constant symbol #fail : Tactic;
builtin "fail" â‰” #fail;

constant symbol #generalize : Î  [a], Ï„ a â†’ Tactic;
builtin "generalize" â‰” #generalize;

constant symbol #have : String â†’ Î  p, Ï€ p â†’ Tactic;
builtin "have" â‰” #have;

constant symbol #induction : Tactic;
builtin "induction" â‰” #induction;

constant symbol #orelse : Tactic â†’ Tactic â†’ Tactic;
builtin "orelse" â‰” #orelse;
notation #orelse infix left 10;

constant symbol #refine : String â†’ Tactic;
builtin "refine" â‰” #refine;

constant symbol #reflexivity : Tactic;
builtin "reflexivity" â‰” #reflexivity;

constant symbol #remove : Î  [a], Ï€ a â†’ Tactic;
builtin "remove" â‰” #remove;

constant symbol #repeat : Tactic â†’ Tactic;
builtin "repeat" â‰” #repeat;

constant symbol #rewrite_gen : String â†’ String â†’ Î  [p], Ï€ p â†’ Tactic;
builtin "rewrite" â‰” #rewrite_gen;

symbol #rewrite : Î  [p], Ï€ p â†’ Tactic â‰” @#rewrite_gen "" "";

constant symbol #set : String â†’ Î  [a], Ï„ a â†’ Tactic;
builtin "set" â‰” #set;

constant symbol #simplify : /* Î  [a], Ï„ a â†’ */ Tactic;
builtin "simplify" â‰” #simplify;

constant symbol #simplify_beta : Tactic;
builtin "simplify rule off" â‰” #simplify_beta;

constant symbol #solve : Tactic;
builtin "solve" â‰” #solve;

constant symbol #symmetry : Tactic;
builtin "symmetry" â‰” #symmetry;

constant symbol #try : Tactic â†’ Tactic;
builtin "try" â‰” #try;

constant symbol #why3 : /*Ï„ (option string) â†’*/ Tactic;
builtin "why3" â‰” #why3;

constant symbol #change [p] : Ï€ p â†’ Tactic;
builtin "change" â‰” #change;

/*****************************************************************************/

symbol nothing â‰” #try #fail;

symbol #do : â„• â†’ Tactic â†’ Tactic;
// notation * infix 20;

rule #do 0 _ â†ª nothing
with #do ($n +1)  $t â†ª $t and (#do $n $t);

// Used to remove trailing `âŠ¥` due to usage of âŸ‡_to_âˆ¨_rw or disj
// in order to compare left and right term in simplification rule.
symbol #repeat_or_id_r : Tactic â‰” #repeat (#rewrite or_identity_r);

/******************************************************************************
*  Definition of Alethe meta tactic        
******************************************************************************/
 
symbol applyAny : ğ•ƒ tactic â†’ Tactic;
rule applyAny ($t0 â¸¬ $tl) â†ª $t0 #orelse (applyAny $tl)
with applyAny Stdlib.List.â–¡ â†ª #fail;

